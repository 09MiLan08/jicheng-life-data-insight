chengdu-data-insight 架构设计文档
 
一、项目概述
 
1. 项目名称
 
chengdu-data-insight（成都数据洞察平台）
 
2. 核心定位
 
以「数据可视化展示 + 标准化接口服务」为核心，整合成都多维度城市数据（美食、地铁、旅游等），提供可直接访问的可视化页面与可复用的API接口，支持数据查询、分析与前端展示场景。
 
3. 技术栈选型
 
- 后端：Python + FastAPI（API开发）、pandas（数据处理）
- 前端：HTML + JavaScript + ECharts（可视化）
- 环境：Python虚拟环境（venv）
- 依赖：requirements.txt（统一版本）
 
二、架构整体设计
 
1. 架构分层（自上而下）
 
用户层 → 前端可视化层 → 接口服务层 → 数据处理层 → 数据存储层
 
各层职责
 
- 用户层：通过浏览器访问页面或调用API接口
- 前端可视化层：通过静态HTML页面结合ECharts，提供直观的数据展示
- 接口服务层：基于FastAPI的路由模块，提供标准化的数据接口
- 数据处理层：封装工具函数，负责数据的读取、清洗、筛选与格式转换
- 数据存储层：通过本地CSV文件存储原始数据
 
2. 核心流程
 
用户访问可视化页面后，页面会请求对应API接口；接口调用工具函数处理数据，工具函数从原始数据文件中读取数据并完成清洗、筛选等操作；处理后的数据通过接口返回给页面，最终渲染图表展示；用户也可直接调用API接口获取数据。
 
三、模块详细设计
 
1. 数据存储模块（data/）
 
核心职责
 
存储原始数据文件，按数据类型分类管理，为数据处理层提供稳定数据源。
 
目录结构
 
data目录下包含raw子目录，专门用于存储未经处理的原始数据文件。raw子目录包含的文件有：成都美食数据文件、成都地铁客流量数据文件、成都旅游数据文件、成都公共服务数据文件、成都消费活力数据文件、成都生态宜居数据文件、成都社区生活数据文件。
 
设计规范
 
- 文件格式统一使用CSV，编码为UTF-8，避免中文乱码
- 文件名采用「数据类型.csv」的命名规则，使用小写字母加下划线分隔
 
2. 前端可视化模块（static/）
 
核心职责
 
提供用户可直接访问的可视化页面，通过ECharts实现折线图、饼图、柱状图等多类型图表展示，同时提供页面导航功能，方便用户切换不同数据模块。
 
目录结构
 
static目录包含首页、charts子目录和js子目录（可选扩展）。首页为导航页，提供所有可视化页面的跳转链接；charts子目录按数据类型拆分单个图表页面，包括美食数据可视化页面、地铁数据可视化页面、旅游数据可视化页面、公共服务数据可视化页面、消费活力数据可视化页面、生态宜居数据可视化页面、社区生活数据可视化页面；js子目录用于存放ECharts通用配置文件，包含主题、样式、通用函数等，便于后续维护和扩展。
 
核心设计
 
每个图表页面聚焦一类数据，通过请求对应API接口获取数据并渲染图表；首页提供清晰的导航入口，支持用户快速切换不同数据模块；JS文件单独存放，便于后续添加图表交互、数据筛选等扩展功能。
 
3. 接口服务模块（routers/）
 
核心职责
 
提供标准化的RESTful API接口，支持前端数据请求与第三方调用；按数据类型分模块管理路由，保证代码结构清晰；能够接收请求参数（如筛选条件、数据范围等），并返回格式化的数据。
 
目录结构
 
routers目录按数据类型划分路由模块，包括美食数据接口模块、地铁数据接口模块、旅游数据接口模块、公共服务数据接口模块、消费活力数据接口模块、生态宜居数据接口模块、社区生活数据接口模块。
 
接口规范
 
- 所有接口统一前缀「/api」，模块路径按数据类型划分，例如美食数据接口路径为「/api/food」
- 查询数据使用GET请求，支持参数筛选（如按区域筛选数据）
- 响应格式统一为JSON，包含状态码、消息和数据字段，便于前端解析
 
4. 工具函数模块（utils/）
 
核心职责
 
封装可复用的数据处理逻辑，避免重复代码；提供数据读取、清洗、筛选、格式转换等通用功能；隔离数据处理与接口服务，降低模块间的耦合度。
 
目录结构
 
utils目录包含数据处理核心工具文件，集中实现各类通用数据处理功能。
 
核心功能
 
- 读取CSV格式的原始数据文件
- 数据清洗，处理缺失值、异常值、重复值等问题
- 按多字段组合条件筛选数据
- 将数据格式化为JSON可序列化格式，便于接口返回
- 按区域筛选特定数据
 
设计规范
 
- 函数命名采用蛇形命名法，保证语义清晰
- 每个函数仅负责单一职责，避免复杂逻辑堆砌
- 处理异常情况（如文件不存在、数据格式错误等），返回明确的错误信息
 
5. 入口与配置模块（根目录）
 
1. main.py
 
核心职责：作为项目的核心入口文件，负责启动FastAPI服务、注册所有路由模块、挂载静态文件，确保项目能够正常运行。
 
2. requirements.txt
 
核心职责：记录项目所需的所有依赖包及对应版本，保证开发环境的一致性，便于他人快速搭建项目运行环境。包含的核心依赖有FastAPI、uvicorn（FastAPI运行服务器）、pandas（数据处理），可根据需求添加Excel文件处理等扩展依赖。
 
四、部署与运行说明
 
1. 环境准备
 
第一步，创建Python虚拟环境；第二步，激活虚拟环境（Windows系统和Mac/Linux系统的激活命令不同）；第三步，通过requirements.txt文件安装项目所需的所有依赖。
 
2. 启动服务
 
通过指定命令启动项目服务，启动成功后可通过两个地址访问：一个是前端可视化首页地址，另一个是API文档页地址（FastAPI自动生成的交互式文档）。
 
3. 访问方式
 
- 本地访问：直接通过浏览器打开启动后的访问地址即可
- 局域网访问：使用本机IP替换本地回环地址，其他设备可在同一局域网内访问
- 线上部署：可将项目部署至阿里云、腾讯云等云服务器，配置域名后即可公开访问
 
五、扩展性设计
 
- 1. 数据扩展：新增数据类型时，只需在raw目录添加对应的CSV文件，新建对应的路由模块和工具函数即可，无需修改现有架构
- 2. 功能扩展：支持添加数据导出功能（如导出Excel、PDF文件）、用户认证功能（如API密钥验证）、数据缓存功能（如使用Redis）等
- 3. 前端扩展：可新增数据对比页面、自定义筛选组件、移动端适配页面等，提升用户体验
- 4. 部署扩展：支持Docker容器化部署，便于环境一致性管理；支持CI/CD自动构建部署，提高部署效率
